package bls

import (
	"fmt"

	"github.com/consensys/linea-monorepo/prover/maths/field"
	"github.com/consensys/linea-monorepo/prover/protocol/dedicated/plonk"
)

const (
	millerLoopInputFillerKey       = "bls12381-miller-loop-input-filler"
	finalExpInputFillerKey         = "bls12381-final-exp-input-filler"
	pointEvalInputFillerKey        = "bls12381-point-eval-input-filler"
	pointEvalFailureInputFillerKey = "bls12381-point-eval-failure-input-filler"
)

func init() {
	plonk.RegisterInputFiller(membershipInputFillerKey(G1, CURVE), newMembershipInputFiller(G1, CURVE))
	plonk.RegisterInputFiller(membershipInputFillerKey(G2, CURVE), newMembershipInputFiller(G2, CURVE))
	plonk.RegisterInputFiller(membershipInputFillerKey(G1, GROUP), newMembershipInputFiller(G1, GROUP))
	plonk.RegisterInputFiller(membershipInputFillerKey(G2, GROUP), newMembershipInputFiller(G2, GROUP))
	plonk.RegisterInputFiller(millerLoopInputFillerKey, inputfillerMillerLoop)
	plonk.RegisterInputFiller(finalExpInputFillerKey, inputFillerFinalExp)
	plonk.RegisterInputFiller(mapToGroupInputFillerKey(G1), inputFillerMapToG1)
	plonk.RegisterInputFiller(mapToGroupInputFillerKey(G2), inputFillerMapToG2)
	plonk.RegisterInputFiller(pointEvalInputFillerKey, inputFillerPointEvaluation)
	plonk.RegisterInputFiller(pointEvalFailureInputFillerKey, inputFillerPointEvaluationFailure)
}

func membershipInputFillerKey(g Group, m membership) string {
	base := "bls12381-%s-membership-input-filler"
	switch m {
	case CURVE:
		return fmt.Sprintf(base, g.StringCurve())
	case GROUP:
		return fmt.Sprintf(base, g.String())
	default:
		panic(fmt.Sprintf("unknown membership type %v for group %v", m, g))
	}
}

func newMembershipInputFiller(g Group, _ membership) plonk.InputFiller {
	// we generate points not on curve --> also not in group
	return func(circuitInstance, inputIndex int) field.Element {
		nbL := nbLimbs(g)
		if (inputIndex+1)%(nbL/2) == 0 {
			return field.One()
		} else {
			return field.Zero()
		}
	}
}

func inputfillerMillerLoop(circuitInstance, inputIndex int) field.Element {
	// prev = 1
	// p = g1 point
	// q = g2 point
	// curr = e(p, q)
	// Each 128-bit limb is split into 8 16-bit sublimbs in little-endian order within the chunk.
	tbl := []string{
		// previous gt accumulator (identity = 1 in C0.B0.A0)
		// C0.B0.A0 = 1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0001", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// C0.B0.A1 = 0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// C0.B1.A0 = 0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// C0.B1.A1 = 0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// C0.B2.A0 = 0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// C0.B2.A1 = 0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// C1.B0.A0 = 0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// C1.B0.A1 = 0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// C1.B1.A0 = 0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// C1.B1.A1 = 0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// C1.B2.A0 = 0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// C1.B2.A1 = 0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",

		// G1
		// G1 X
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x9697", "0xeca9", "0x212d", "0x1765", "0xf013", "0xf9d1", "0xe308", "0x09ec",
		"0x3ff9", "0x335b", "0x0a51", "0xf378", "0xa5f1", "0x9be9", "0xd61f", "0xb112",
		"0x5224", "0x024e", "0xc0c9", "0x96d2", "0x179b", "0x2ca2", "0x7a0b", "0x8174",
		// G1 Y
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0xf80c", "0x89c5", "0x6233", "0x8a84", "0xb09f", "0xa6f5", "0x80d3", "0x032b",
		"0x3be6", "0x0fd4", "0x2731", "0x9d9c", "0x097f", "0xabc3", "0x0cdd", "0xa69a",
		"0x30d1", "0x90ae", "0x3b05", "0xa347", "0xf45c", "0x634a", "0x256c", "0xe745",

		// G2
		// G2 X.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0xd586", "0xcc7e", "0x0f17", "0xd237", "0x40a9", "0x57d5", "0x5339", "0x1638",
		"0xdbae", "0x4d00", "0x1e1e", "0xe1ea", "0x5e0e", "0xb882", "0xb995", "0x3bc0",
		"0xa053", "0xb827", "0xaaca", "0xc952", "0x1b78", "0xf361", "0x4b0b", "0x81f1",
		// G2 X.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x124f", "0x730a", "0x0e47", "0x9f52", "0x7f72", "0xc1ed", "0xdef9", "0x0a4e",
		"0x1572", "0x031e", "0x14d1", "0x7281", "0x1074", "0x04ba", "0x62a9", "0xd706",
		"0x3577", "0x47c3", "0x288c", "0x6178", "0xc72a", "0xb57e", "0x86f6", "0xc6c8",
		// G2 Y.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x5678", "0x2b52", "0x8dca", "0x0aeb", "0xb063", "0x0d82", "0xfb44", "0x0468",
		"0xaa8a", "0x1e47", "0xbd22", "0xbfe6", "0x009c", "0xbf91", "0xda69", "0x9a66",
		"0x9899", "0x1e4c", "0x95d7", "0x999d", "0xf3bd", "0x764b", "0xece9", "0xe88d",
		// G2 Y.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x7136", "0x3f88", "0x6154", "0x38b3", "0xdd26", "0xfa65", "0x4552", "0x0f6d",
		"0x08f5", "0x13c3", "0x3f7a", "0x9700", "0x4116", "0xc66c", "0x53d9", "0xa432",
		"0xccf3", "0x6e36", "0xfd8b", "0xacde", "0x8967", "0xa59c", "0x1aa0", "0x422e",

		// next accumulator
		// C0.B0.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x041a", "0x0eb1", "0xabcd", "0x41c8", "0xad3a", "0xd82e", "0xfeae", "0x0054",
		"0x1df5", "0x51ba", "0x7937", "0xed49", "0x8e88", "0x7733", "0x4245", "0xd2fe",
		"0x1e1f", "0x622d", "0x38d3", "0x5361", "0x96af", "0x929d", "0x60cd", "0xdf7c",
		// C0.B0.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0619", "0xf08f", "0xdcb8", "0x11b7", "0x550a", "0x97a1", "0x8608", "0x1896",
		"0x59a5", "0x76d5", "0x99f8", "0xa67b", "0xadcf", "0xf40e", "0x26fb", "0x7934",
		"0x6dc7", "0x00db", "0xc8b8", "0x3c86", "0xf10a", "0xf064", "0x7952", "0xbe8a",
		// C0.B1.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x7a0b", "0xa88a", "0x5b92", "0xf39e", "0xe83c", "0x21b4", "0x61b1", "0x10d4",
		"0x663a", "0x8fb7", "0x208b", "0x3839", "0x1904", "0x3d08", "0x1260", "0x7c6a",
		"0xc305", "0xab22", "0x9e53", "0xab95", "0x296d", "0x82fb", "0xa57a", "0x319c",
		// C0.B1.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x01ad", "0x14da", "0x76fe", "0x5a39", "0xd455", "0x53cb", "0x0376", "0x1797",
		"0x9d87", "0xd6a6", "0xcd99", "0xc62f", "0x8280", "0x2376", "0xe7cd", "0x864b",
		"0x20c4", "0xd741", "0x249f", "0xfac5", "0x220d", "0x0e93", "0x2f34", "0x2d81",
		// C0.B2.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x1bac", "0x49ce", "0x8dc6", "0x7547", "0x6dcf", "0x83f9", "0xbd68", "0x166b",
		"0x45a5", "0x1e5e", "0x8426", "0xac1b", "0xa745", "0xd621", "0x26b9", "0xefe6",
		"0xac56", "0xe911", "0xdac5", "0x6508", "0xe59c", "0xff43", "0xf850", "0xb2f5",
		// C0.B2.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0xb806", "0x3b6c", "0x84ee", "0x418a", "0x0bc7", "0xb14d", "0x8944", "0x0427",
		"0x7eae", "0x0b74", "0x71ef", "0x2820", "0xc24b", "0x9c01", "0x281b", "0xd5c9",
		"0x56d4", "0xb8d7", "0x5c07", "0x8abb", "0x78a5", "0x9fb8", "0xc784", "0x49b7",
		// C1.B0.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0xee05", "0x873c", "0x4da5", "0x8768", "0x3901", "0x49dd", "0x87ad", "0x11fd",
		"0x1809", "0x5d5e", "0x7e78", "0xdf93", "0x7f02", "0x854f", "0xac54", "0x118d",
		"0xd91a", "0x23fb", "0xadf0", "0xc57b", "0x8e5d", "0x6519", "0xba41", "0x586c",
		// C1.B0.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x4eb7", "0x0b98", "0x38ab", "0xf00a", "0xd05d", "0x92ec", "0x08f3", "0x0a23",
		"0xe348", "0x64cc", "0x131c", "0x27de", "0xd030", "0x4e11", "0xa84f", "0xaf3e",
		"0xb1ee", "0x1847", "0x5cb7", "0x5c92", "0x3298", "0xdaae", "0x35c3", "0x7dfb",
		// C1.B1.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x5425", "0x6816", "0xa313", "0x8d78", "0x953d", "0xdfc2", "0x5dbf", "0x084d",
		"0x4e28", "0x9989", "0x2f83", "0x622f", "0xfc8b", "0x3b5d", "0x50b1", "0xcb10",
		"0x0e35", "0x2aa8", "0x1259", "0x6fa0", "0xdc39", "0x2860", "0xa0c7", "0xa506",
		// C1.B1.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x5424", "0x4980", "0x5073", "0x45b1", "0x05b2", "0x79f1", "0x8a85", "0x01ca",
		"0x43ce", "0x9bb8", "0x9a1b", "0x1487", "0xc68d", "0x6398", "0xe57b", "0x8dc9",
		"0xd304", "0x4483", "0x210e", "0x9405", "0xba9e", "0x640a", "0xf975", "0x9d61",
		// C1.B2.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0xda19", "0x258a", "0xa70a", "0xc697", "0x468d", "0x0ce2", "0x5c73", "0x14de",
		"0x72fe", "0x7649", "0x6b55", "0xb248", "0xe2e8", "0xc859", "0xd83a", "0xb41d",
		"0x192f", "0x906b", "0x7ca7", "0xdbd7", "0x999c", "0x2911", "0x0999", "0x67b8",
		// C1.B2.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0xe5d7", "0x8e22", "0xd68f", "0xd267", "0x85ee", "0xce9a", "0x075a", "0x1891",
		"0xf6be", "0xf02e", "0x467d", "0x4509", "0x0389", "0x0c56", "0x8cdd", "0x93fd",
		"0xfe20", "0x99e2", "0xb249", "0x4d5b", "0x695a", "0x6d55", "0x546f", "0xc739",
	}
	var res field.Element
	_, err := res.SetString(tbl[inputIndex%nbRowsPerMillerLoop])
	if err != nil {
		panic(fmt.Sprintf("failed to set string: %v", err))
	}
	return res
}

func inputFillerFinalExp(circuitInstance, inputIndex int) field.Element {
	// accumulator e(-p, q)
	// inputs e(p, q)
	// result e(-p, q) * e(p, q) == 1
	// Each 128-bit limb is split into 8 16-bit sublimbs in little-endian order within the chunk.
	tbl := []string{
		// gt accumulator (e(-g1, g2))
		// C0.B0.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0xeb1e", "0xaf1b", "0x738a", "0xa063", "0x6267", "0x25b0", "0xb481", "0x04b3",
		"0xd6c2", "0x9534", "0x13b8", "0x0b0f", "0x64ab", "0xd527", "0xf2ee", "0x58d3",
		"0x57af", "0x1e1a", "0x0121", "0xb29f", "0xc304", "0xf2dc", "0x4072", "0xeeed",
		// C0.B0.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x9192", "0xd169", "0x90e8", "0x4b0a", "0x24a2", "0xc039", "0x5fb8", "0x0717",
		"0x75fe", "0x8277", "0xe1cf", "0xd5f4", "0xa26c", "0xb111", "0x2ffe", "0xfeed",
		"0x5610", "0x9ac7", "0x4acf", "0x906e", "0x4f47", "0x5522", "0xfe81", "0xd936",
		// C0.B1.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x603d", "0xc72c", "0x63cc", "0x9855", "0xb36d", "0xdc06", "0xbc0c", "0x06ce",
		"0x5812", "0xb45a", "0xd3c9", "0xa278", "0x17f3", "0x285f", "0xc322", "0x5023",
		"0x2cdc", "0x3d39", "0x9da4", "0x9ae9", "0x7605", "0x80ed", "0x78f0", "0xfbc7",
		// C0.B1.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0xf9bc", "0xb11d", "0xa1a9", "0x87cb", "0xfa8b", "0x4c14", "0x8cef", "0x1780",
		"0x8925", "0x643a", "0x2919", "0xce94", "0xa149", "0x82f1", "0xc798", "0x7a6d",
		"0x8c65", "0xbcac", "0xffe6", "0x6724", "0xf24e", "0x6c0d", "0x0de0", "0xea9f",
		// C0.B2.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x3d6a", "0xa2cd", "0xf37f", "0x09d7", "0xb021", "0xa0c9", "0xb210", "0x0fe9",
		"0xafdb", "0x8322", "0x8eac", "0x082e", "0x9c86", "0x2670", "0x0dcb", "0x19cd",
		"0x5127", "0x9e1e", "0xf76a", "0x5daf", "0x0491", "0x794c", "0xb8a8", "0x5acb",
		// C0.B2.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0xee04", "0x3688", "0xdd51", "0xad04", "0x03eb", "0x84c3", "0xff49", "0x00be",
		"0xc5c6", "0xa521", "0x1a06", "0x3530", "0x66e1", "0x1ece", "0x657e", "0x20e5",
		"0xecd9", "0x9cbb", "0x3a86", "0x8484", "0x1c5a", "0x05c5", "0x5297", "0x981c",
		// C1.B0.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0b77", "0xd469", "0x455b", "0x6b20", "0x987a", "0x8417", "0x4c0e", "0x0776",
		"0x9512", "0xf787", "0xee23", "0x08e4", "0xf3e3", "0x7fdd", "0x9c2a", "0xf8a8",
		"0x8bce", "0xb209", "0x7fc6", "0xb849", "0x7271", "0xdf2b", "0xa0be", "0x2bd6",
		// C1.B0.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x9b07", "0xa203", "0x93f7", "0x2f1f", "0xca96", "0x56c7", "0x4605", "0x0640",
		"0xb94c", "0x94be", "0x1d08", "0x1b89", "0xf39b", "0xfb37", "0xf083", "0xe23a",
		"0x6367", "0xf373", "0x58e3", "0x38bc", "0x47ee", "0xda78", "0x892f", "0x73e2",
		// C1.B1.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x915f", "0xd05e", "0x3873", "0x2291", "0x96d5", "0x3750", "0x26bd", "0x1412",
		"0x1dfb", "0x71fd", "0xd289", "0xa228", "0xc9d8", "0x028a", "0x7111", "0x5ef6",
		"0xb2e8", "0x6934", "0xf3ff", "0xcda0", "0x9dec", "0x3235", "0x4285", "0xf795",
		// C1.B1.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x6f83", "0x1877", "0xb6a0", "0x78ca", "0x7d88", "0x2f1a", "0x88ae", "0x0d46",
		"0xc5cf", "0xf28b", "0x0abf", "0x1994", "0x2a13", "0x1e4f", "0xab76", "0x398a",
		"0xa951", "0x208d", "0x0033", "0xb449", "0x83fb", "0x4563", "0x8bfe", "0x74a6",
		// C1.B2.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x1fc7", "0x686c", "0x7102", "0x5f91", "0xef4c", "0xc3c3", "0x7896", "0x0abc",
		"0xc95d", "0xe42c", "0x0b64", "0x24ca", "0x8c91", "0x0177", "0x9f23", "0xf871",
		"0xd8c1", "0x8b6a", "0x8a1e", "0xb2ce", "0x21c4", "0x7d00", "0x0539", "0x2657",
		// C1.B2.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x76a3", "0xc5d3", "0xb319", "0x134b", "0x9504", "0x7fbe", "0x0beb", "0x0656",
		"0x580b", "0x7ac4", "0x0fbe", "0x23a9", "0x0e8b", "0x690c", "0x5c83", "0xf85b",
		"0x95db", "0x38f0", "0x3a43", "0xb678", "0x580e", "0x9590", "0xf2a2", "0x3223",

		// G1 input (g1 generator)
		// G1 X
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0xac0f", "0x4fa9", "0x638c", "0x2695", "0xd794", "0x3197", "0xd3a7", "0x17f1",
		"0xac58", "0x171b", "0x3a3f", "0xa14e", "0xb905", "0x9774", "0x8c4f", "0xc368",
		"0xc6bb", "0xdb22", "0xf00a", "0xfb3a", "0x1aef", "0xf97a", "0xe83f", "0x6c55",
		// G1 Y
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x8ae4", "0x741d", "0x30ed", "0xa09e", "0xa0f1", "0xe3aa", "0xf481", "0x08b3",
		"0xb3ed", "0x2c04", "0x18cb", "0x00db", "0x0af6", "0xd5d0", "0xe095", "0xfcf5",
		"0xe7e1", "0x46c5", "0x2329", "0x0caa", "0x8ae4", "0xa288", "0xc744", "0xd03c",

		// G2 input (g2 generator)
		// G2 X.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x1051", "0x2dc5", "0x0527", "0x2608", "0x0a91", "0xf08f", "0xa2b2", "0x024a",
		"0xd177", "0x7ae3", "0x0b64", "0xb451", "0x3b02", "0xfa40", "0x7ad4", "0xc6e4",
		"0xbdb8", "0xc121", "0x56c8", "0xd480", "0xbbef", "0xa805", "0x0326", "0x0bac",
		// G2 X.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x4f65", "0x8827", "0xd3a0", "0x7dac", "0x9f60", "0x5271", "0x2b60", "0x13e0",
		"0x5049", "0xdc7f", "0x61bb", "0xb5da", "0xb61a", "0x9920", "0xd0d0", "0x596b",
		"0x2b7e", "0x5d04", "0x7d05", "0xe5ac", "0x5d57", "0x1394", "0xf112", "0x334c",
		// G2 Y.A0
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x351a", "0xda2e", "0xcdc6", "0x8cc9", "0x6e11", "0x727d", "0xd527", "0x0ce5",
		"0xd12c", "0x5160", "0x9a69", "0x6d42", "0xd3a7", "0x8cbd", "0x9baa", "0xadfd",
		"0x2801", "0x08b8", "0x5486", "0xe193", "0xa289", "0x3bac", "0xc9cc", "0x923a",
		// G2 Y.A1
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x8b99", "0x2bc2", "0xd2b0", "0x32ac", "0x34cc", "0x2ea7", "0xc4a0", "0x0606",
		"0x99ab", "0x572e", "0x92ab", "0x2674", "0x63af", "0x85a7", "0x287e", "0xcb3e",
		"0x79be", "0xf05f", "0x075f", "0xaaa9", "0x1da1", "0x5cec", "0x0d27", "0x3f37",

		// pairing check result (0 = false, 1 = true per 16-bit unit)
		"0x00", "0x01",
	}
	var res field.Element
	_, err := res.SetString(tbl[inputIndex%nbRowsPerFinalExp])
	if err != nil {
		panic(fmt.Sprintf("failed to set string: %v", err))
	}
	return res
}

func mapToGroupInputFillerKey(g Group) string {
	return fmt.Sprintf("bls12381-map-%s-to-%s-input-filler", g.StringMap(), g.String())
}

func inputFillerMapToG1(circuitInstance, inputIndex int) field.Element {
	// map of 0
	tbl := []string{
		// fp element
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// g1 x
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x5037", "0xd14e", "0xde9a", "0x5c30", "0x332d", "0x2b8f", "0xa037", "0x11a9",
		"0xbcac", "0xfb93", "0xf2d6", "0x5097", "0xf2fa", "0x45d5", "0xfa4c", "0x2a73",
		"0xa415", "0x7d0e", "0x870c", "0x0519", "0x43db", "0x11ac", "0x2e17", "0x592f",
		// g1 y
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x8de2", "0xa378", "0xc24b", "0x9f51", "0xa071", "0x4164", "0x0f99", "0x092c",
		"0xcd63", "0x6a47", "0xe8bc", "0x5116", "0x8c44", "0x55f5", "0x926b", "0x40ff",
		"0x2133", "0x7322", "0x6ee7", "0xeaa9", "0xdf9f", "0xe22b", "0xd4e8", "0x392f",
	}
	var res field.Element
	_, err := res.SetString(tbl[inputIndex%nbRowsPerG1Map])
	if err != nil {
		panic(fmt.Sprintf("failed to set string: %v", err))
	}
	return res
}

func inputFillerMapToG2(circuitInstance, inputIndex int) field.Element {
	// map of (0, 0)
	tbl := []string{
		// fp2 element
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",

		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",

		// g2 x Re
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x9ce2", "0x8dc2", "0x1984", "0xd5e6", "0xeef9", "0x6ec9", "0x2089", "0x0183",
		"0x61f1", "0x79cd", "0xec0c", "0x9d44", "0x1d9b", "0x2dd3", "0x13d0", "0x66f4",
		"0xbfce", "0xb324", "0x27a4", "0xb7ff", "0xbd20", "0xa6d7", "0x5ddb", "0x8b07",

		// g2 x Im
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0xfa7e", "0xb3eb", "0x2e86", "0xb02d", "0xa35b", "0x18b5", "0xd121", "0x0a67",
		"0x6ffa", "0x95e9", "0x25fa", "0x6d70", "0x9fb0", "0x3de3", "0x0db9", "0x2341",
		"0x8892", "0xac65", "0xd251", "0xb40b", "0x4dd4", "0xc3ae", "0x7a27", "0x428a",

		// g2 y Re
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0xd2b8", "0x46ba", "0x6b32", "0x2125", "0xa2c3", "0x44d1", "0xe036", "0x0260",
		"0x3460", "0xa0d3", "0x5106", "0x5df5", "0xe6f8", "0x90cb", "0xd138", "0x95ca",
		"0x5941", "0x5bc3", "0x7186", "0x0062", "0xd878", "0xa042", "0x43c7", "0x4fb1",

		// g2 y Im
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x3f18", "0x05e6", "0x9d58", "0x0767", "0x0bda", "0xa43f", "0x9777", "0x04c6",
		"0x76ae", "0x9b4f", "0x6d19", "0x7026", "0xac7f", "0x6112", "0x0e7c", "0xcf4e",
		"0xdf5c", "0x76aa", "0x6e9a", "0x3080", "0xbdae", "0x3cee", "0x269a", "0x27c6",
	}
	var res field.Element
	_, err := res.SetString(tbl[inputIndex%nbRowsPerG2Map])
	if err != nil {
		panic(fmt.Sprintf("failed to set string: %v", err))
	}
	return res
}

func inputFillerPointEvaluation(circuitInstance, inputIndex int) field.Element {
	tbl := []string{
		// versioned hash
		"0x0106", "0x57f3", "0x7554", "0xc781", "0x402a", "0x2291", "0x7dee", "0x2f75",
		"0xdef7", "0xab96", "0x6d7b", "0x7709", "0x0539", "0x8eba", "0x3c44", "0x4014",
		// evaluation point
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// claimed value
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// commitment compressed
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// proof compressed
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		// expected blob size
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000",
		"0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x0000", "0x1000",
		// expected bls modulus
		"0x73ed", "0xa753", "0x299d", "0x7d48", "0x3339", "0xd808", "0x09a1", "0xd805",
		"0x53bd", "0xa402", "0xfffe", "0x5bfe", "0xffff", "0xffff", "0x0000", "0x0001",
	}
	var res field.Element
	_, err := res.SetString(tbl[inputIndex%nbRowsPerPointEval])
	if err != nil {
		panic(fmt.Sprintf("failed to set string: %v", err))
	}
	return res
}

func inputFillerPointEvaluationFailure(circuitInstance, inputIndex int) field.Element {
	var res field.Element
	return res
}
